@extends('adm_theme::layouts.app')
@section('content')
    @php
        // $last_item = last($items);
        // $last_container = last($containers);
        // $types = Str::camel(Str::plural($last_container));
        // $field = (object) [
        //     'name' => 'areas',
        //     'type' => 'PivotFields',
        // ];
    @endphp
    <x-section type="crud">
        <x-include-view view="topbar" />

        @foreach ($rows as $key => $row)
            @php
                $fields = $_panel->getFields('index');
                $row_panel = Panel::make()->get($row);
                $row_panel->setParent($_panel->getParent());
                $row_panel->setName($_panel->getName());
            @endphp
            @if ($loop->first)
                <table class="table table-striped table-hover table-sm">
                    <thead class="thead-light">
                        <tr>
                            @foreach ($fields as $field)
                                <td>{{ str_replace('_', ' ', $field->name) }}</td>
                            @endforeach
                            <td></td>
                        </tr>
                    </thead>
                    <tbody>
            @endif
            <tr>
                @foreach ($fields as $field)
                    <td>
                        {!! Theme::inputFreeze($field, $row) !!}
                        @if ($loop->first)
                            @foreach ($row_panel->itemActions() as $act)
                                {!! $act->btnHtml() !!}
                            @endforeach
                        @endif
                    </td>
                @endforeach
                <td>
                    {!! $row_panel->btnCrud() !!}
                </td>
            </tr>
            @if ($loop->last)
                </tbody>
                </table>
            @endif
        @endforeach
        {{ $rows->links() }}
    </x-section>
@endsection
